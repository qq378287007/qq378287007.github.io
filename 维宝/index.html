<!DOCTYPE html>

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no, width=device-width">
  <link rel="stylesheet" href="chatbox.css">
  <title>维宝日志</title>
</head>

<script src="https://cdn.bootcss.com/jquery/3.5.0/jquery.js"></script>

<body>
  <h1>与维宝相识的日子：<font color=red style='font-size:45px;font-family:宋体'>2024年2月23日11时49分</font>
  </h1>
  <h1>第一次见面的日子：<font color=red style='font-size:45px;font-family:宋体'>2024年5月2日17时20分</font>
  </h1>
  <h1 id="date1"></h1>
  <h1 id="date2"></h1>
  <script>
    setInterval(function () {
      var curDate = new Date();// 获取当前日期
      var day, hour, minute, second, interval;

      interval = curDate - new Date('2024-2-23 11:49:00');
      interval /= 1000;
      day = Math.round(interval / 60 / 60 / 24);
      hour = Math.round(interval / 60 / 60 % 24);
      minute = Math.round(interval / 60 % 60);
      second = Math.round(interval % 60);
      document.getElementById('date1').innerHTML = "相知相识的第<font color=red style='font-size:45px;font-family:宋体'>" + day + "天" + hour + "时" + minute + "分" + second + "秒</font>";

      interval = curDate - new Date('2024-5-6 00:00:00');
      interval /= 1000;
      day = Math.round(interval / 60 / 60 / 24);
      hour = Math.round(interval / 60 / 60 % 24);
      minute = Math.round(interval / 60 % 60);
      second = Math.round(interval % 60);
      document.getElementById('date2').innerHTML = "思念维宝的第<font color=red style='font-size:45px;font-family:宋体'>" + day + "天" + hour + "时" + minute + "分" + second + "秒</font>";
    }, 1);
  </script>

  <script src="readTxt.js"></script>
  <label for="missing-date">思念日期：</label>
  <input id="missing-date" type="date" name="start_date" min="2024-05-06" max="2100-01-01" onchange="myFunction()" />
  <div id="content"> </div>
  <script>
    function updateNowDate() {
      var today = new Date();
      var year = today.getFullYear();
      var month = today.getMonth() + 1; 
      var day = today.getDate();

      var formattedDate = year + "-" + (month < 10 ? "0" + month : month) + "-" + (day < 10 ? "0" + day : day);
      document.getElementById("missing-date").value = formattedDate;
    }

    function readTxtFile(fileName) {
      const request = new XMLHttpRequest();
      request.onreadystatechange = function () {
        if (request.readyState === 4 && request.status !== 404) {
          onReadTxtFile(request.responseText, fileName);
        } else {
          document.getElementById("content").innerHTML = '';
        }
      }
      request.open('GET', fileName, true); 
      request.send(); 
    }

    function onReadTxtFile(fileString, fileName) {
      const txtDoc = new TxtDoc(fileName);
      const strs = txtDoc.parse(fileString);
      document.getElementById("content").innerHTML = strs;
    }

    function myFunction() {
      var x = document.getElementById("missing-date");
      var date_str = x.value.replace(/-/g, "");
      console.log(date_str);
      readTxtFile(date_str + '.txt');
    }
    updateNowDate();
  </script>
</body>

</html>